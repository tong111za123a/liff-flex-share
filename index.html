<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üòçüñ§‚û£‡ªÇ„ÅÆ·Äî·Äê’É‡∏±‡πà’Å¬π‚úØüñ§üòç</title>

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
body{
  margin:0;
  min-height:100vh;
  font-family:sans-serif;
  background:url('https://i.postimg.cc/j5Gkxs3K/IMG-1275.gif') center/cover fixed;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
}
.panel{
  width:92%;
  max-width:360px;
  background:rgba(0,0,0,.75);
  padding:15px;
  border-radius:10px;
  text-align:center;
}
input{
  width:95%;
  padding:10px;
  margin-top:8px;
  background:#222;
  color:#fff;
  border:none;
  border-radius:5px;
}
button{
  margin-top:10px;
  padding:10px;
  font-size:15px;
  background:#000;
  color:#0ff;
  border:1px solid #0ff;
  border-radius:5px;
}
button:hover{
  background:#0ff;
  color:#000;
}
.qr img{
  width:150px;
  margin-top:10px;
  border:2px solid #0ff;
  border-radius:8px;
}
.hidden{display:none;}
.small{
  font-size:12px;
  color:#0ff;
  word-break:break-all;
  white-space:pre-line;
}
hr{
  border-color:#333;
  margin:15px 0;
}
</style>
</head>

<body>

<!-- üîê ‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™ -->
<div class="panel" id="loginPanel">
  <h3>üîê ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h3>
  <input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô">
  <button onclick="checkAccess()">‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>

  <hr>

  <!-- ‚ûï ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ + QR -->
  <button onclick="contactCreator()">‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏°‡∏±‡∏Ñ‡∏£ 300/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Ñ‡∏•‡∏¥‡∏Å!</button>
  <div class="qr">
    <img src="https://img5.pic.in.th/file/secure-sv1/IMG_12468d6ce5b9565e3489.jpeg">
    <p class="small">‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏≠‡∏î LINE ‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</p>
  </div>

  <hr>

  <!-- üîç ‡πÄ‡∏ä‡πá‡∏Ñ UserID (‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°) -->
  <button onclick="checkMyUserId()">üîç ‡πÄ‡∏ä‡πá‡∏Ñ UserID ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</button>

  <!-- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏ä‡πá‡∏Ñ MID -->
  <button onclick="checkMyMidAuthKey()">üîë ‡πÄ‡∏ä‡πá‡∏Ñ MID / AuthKey</button>

  <div id="myUserId" class="small"></div>
</div>

<!-- ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå -->
<div class="panel hidden" id="denyPanel">
  <h3>‚õî ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
  <p class="small">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</p>
  <button onclick="contactCreator()">‚ûï ‡πÅ‡∏≠‡∏î LINE ‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
  <div class="qr">
    <img src="https://img5.pic.in.th/file/secure-sv1/IMG_12468d6ce5b9565e3489.jpeg">
  </div>
</div>

<!-- ‚úÖ ‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á -->
<div class="panel hidden" id="mainPanel">
  <h3 id="greeting">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ</h3>

  <p class="small">‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ ‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡πÑ‡∏≠‡∏î‡∏µ‡πÑ‡∏•‡∏ô‡πå</p>
  <input id="genInput" placeholder="URL‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡πÑ‡∏≠‡∏î‡∏µ‡πÑ‡∏•‡∏ô‡πå">

  <button onclick="sendFlex()">‡πÅ‡∏ä‡∏£‡πå Flex</button>
  <button onclick="window.location.href='https://pic.in.th/?lang=th'"
    style="border-color:#ff00ff;color:#ff00ff">
    ‡∏ù‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
  </button>

  <hr>

  <!-- üîç ‡πÄ‡∏ä‡πá‡∏Ñ UserID (‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°) -->
  <button onclick="checkMyUserId()">üîç ‡πÄ‡∏ä‡πá‡∏Ñ UserID</button>

  <!-- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏ä‡πá‡∏Ñ MID -->
  <button onclick="checkMyMidAuthKey()">üîë ‡πÄ‡∏ä‡πá‡∏Ñ MID / AuthKey</button>

  <div id="myUserId2" class="small"></div>
</div>

<script>
/* ========== ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ========== */

// üî¥ LIFF ID
const LIFF_ID = "2008621627-1eN2VA2x";

// üîê ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
const PASSWORD = "357000";

// üëë LINE ‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á
const ADMIN_LINE = "mc357.com";

// ‚úÖ ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (‡∏ä‡∏∑‡πà‡∏≠ + UserID)
const WHITELIST = [
  { name: "‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö", userId: "Ua48c35a3cd7641afee1d85c317032ad5" },
  { name: "‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö", userId: "Uffa99b9ba90b2d097eb5300c6a521560" }
];

/* ============================ */

liff.init({ liffId: LIFF_ID });

async function checkAccess(){
  if(document.getElementById("password").value.trim() !== PASSWORD){
    return deny();
  }

  if(!liff.isLoggedIn()) liff.login();
  const p = await liff.getProfile();

  const allowedUser = WHITELIST.find(w => w.userId === p.userId);
  if(!allowedUser) return deny();

  loginPanel.classList.add("hidden");
  mainPanel.classList.remove("hidden");

  greeting.innerText =
    "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏∏‡∏ì " + (allowedUser.name || p.displayName);
}

function deny(){
  loginPanel.classList.add("hidden");
  mainPanel.classList.add("hidden");
  denyPanel.classList.remove("hidden");
}

function contactCreator(){
  location.href = "https://line.me/ti/p/~" + ADMIN_LINE;
}

// üîç ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°
async function checkMyUserId(){
  if(!liff.isLoggedIn()) liff.login();
  const p = await liff.getProfile();

  const text =
`{ name: "${p.displayName}", userId: "${p.userId}" },`;

  document.getElementById("myUserId").innerText = text;
  const el2 = document.getElementById("myUserId2");
  if(el2) el2.innerText = text;
}

// ===============================
// ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°: ‡πÄ‡∏ä‡πá‡∏Ñ MID + AuthKey (‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á userId)
// ===============================
async function checkMyMidAuthKey(){
  if(!liff.isLoggedIn()){
    liff.login();
    return;
  }

  const p = await liff.getProfile();
  const mid = p.userId; // MID
  const randomKey = Math.random().toString(36).substring(2,18);
  const authKey = `${mid}:${randomKey}`;

  const text =
`{
  mid: "${mid}",
  authKey: "${authKey}"
},`;

  document.getElementById("myUserId").innerText = text;
  const el2 = document.getElementById("myUserId2");
  if(el2) el2.innerText = text;
}

// ‡∏™‡πà‡∏á Flex (‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°)
async function sendFlex(){
  if(!liff.isInClient()) return alert("‚ö† ‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE");

  const raw = genInput.value.trim().split(" ");
  if(raw.length < 2) return alert("‚ùå format ‡∏ú‡∏¥‡∏î");

  const flexMsg = {
    type:"flex",
    altText:"‡∏™‡∏ô‡πÉ‡∏à‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠_lineid: mc357.com",
    contents:{
      type:"bubble",
      hero:{
        type:"image",
        url:raw[0],
        size:"full",
        aspectMode:"cover",
        aspectRatio:"2:3"
      },
      action:{
        type:"uri",
        uri:"https://line.me/ti/p/~"+raw[1]
      }
    }
  };

  await liff.shareTargetPicker([flexMsg]);
}
</script>

</body>
</html>